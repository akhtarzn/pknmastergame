<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="pknmaster.png">
    <title>PKN Master - Games by Akhtar Teams</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        secondary: '#ec4899',
                        accent: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        body { 
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }
        
        /* Enhanced Desktop Animations */
        .gradient-bg { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease-in-out infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        /* Desktop Card Hover Effects */
        .desktop-card {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
        }
        
        .desktop-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }
        
        .desktop-card:hover::before {
            left: 100%;
        }
        
        .desktop-card:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        /* Desktop Sidebar */
        .desktop-sidebar {
            width: 300px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .desktop-sidebar.collapsed {
            width: 80px;
        }
        
        .desktop-main-content {
            margin-left: 300px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .desktop-main-content.expanded {
            margin-left: 80px;
        }
        
        /* Enhanced Tooltips */
        .tooltip {
            position: relative;
        }
        
        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            z-index: 1000;
            margin-bottom: 5px;
        }
        
        .tooltip:hover::after {
            opacity: 1;
        }
        
        /* Keyboard Shortcuts Display */
        .keyboard-shortcut {
            display: inline-flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.25);
            border-radius: 4px;
            padding: 2px 6px;
            font-size: 10px;
            font-family: 'Courier New', monospace;
            margin-left: auto;
            min-width: 40px;
            justify-content: center;
        }
        
        /* Desktop Progress Bars */
        .desktop-progress {
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        
        .desktop-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            border-radius: 4px;
            transition: width 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
        }
        
        .desktop-progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(
                -45deg,
                rgba(255, 255, 255, .2) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255, 255, 255, .2) 50%,
                rgba(255, 255, 255, .2) 75%,
                transparent 75%,
                transparent
            );
            background-size: 20px 20px;
            animation: progressShine 2s linear infinite;
        }
        
        @keyframes progressShine {
            0% { background-position: 0 0; }
            100% { background-position: 20px 20px; }
        }
        
        /* Desktop Quiz Enhancements */
        .desktop-quiz-option {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }
        
        .desktop-quiz-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .desktop-quiz-option:hover::before {
            left: 100%;
        }
        
        .desktop-quiz-option:hover {
            transform: translateX(6px);
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.15);
        }
        
        .desktop-quiz-option.correct {
            background: rgba(16, 185, 129, 0.1);
            border-color: #10b981;
            color: #065f46;
            transform: scale(1.02);
        }
        
        .desktop-quiz-option.incorrect {
            background: rgba(239, 68, 68, 0.1);
            border-color: #ef4444;
            color: #991b1b;
        }
        
        .desktop-quiz-option.disabled {
            pointer-events: none;
            opacity: 0.7;
        }
        
        /* Desktop Modal Enhancements */
        .desktop-modal {
            backdrop-filter: blur(12px);
            background: rgba(0, 0, 0, 0.6);
        }
        
        .desktop-modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        /* Desktop Focus States */
        .desktop-focus:focus {
            outline: 2px solid #6366f1;
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }
        
        /* Desktop Selection States */
        ::selection {
            background: rgba(99, 102, 241, 0.3);
        }
        
        /* Desktop Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }
        
        /* Celebration Animation */
        @keyframes celebrate {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.05) rotate(2deg); }
            50% { transform: scale(1.1) rotate(-2deg); }
            75% { transform: scale(1.05) rotate(1deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        
        .celebrate {
            animation: celebrate 0.6s ease-in-out;
        }
        
        /* Desktop Stats Cards */
        .stats-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .stats-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        /* Desktop Window Panel */
        .window-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        /* Desktop Navigation Active State */
        .nav-item.active {
            background: rgba(255, 255, 255, 0.25);
            transform: translateX(4px);
        }
        
        /* Desktop Timer Animation */
        .timer-warning {
            animation: timerPulse 1s ease-in-out infinite;
        }
        
        @keyframes timerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        /* Desktop Leaderboard Styling */
        .leaderboard-row {
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .leaderboard-row:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* Desktop Responsive Adjustments */
        @media (max-width: 1024px) {
            .desktop-sidebar {
                width: 250px;
            }
            .desktop-main-content {
                margin-left: 250px;
            }
        }
        
        @media (max-width: 768px) {
            .desktop-sidebar {
                transform: translateX(-100%);
                position: fixed;
                z-index: 50;
            }
            .desktop-sidebar.mobile-open {
                transform: translateX(0);
            }
            .desktop-main-content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Desktop Sidebar -->
    <div id="desktopSidebar" class="desktop-sidebar fixed left-0 top-0 h-full gradient-bg text-white z-40 shadow-2xl">
        <div class="p-6">
            <!-- Logo -->
            <div class="flex items-center space-x-3 mb-8">
                <img src="pknmaster.png" alt="Target" class="w-6 h-6 mr-2" />
                <div id="sidebarTitle" class="transition-opacity duration-300">
                    <h1 class="text-xl font-bold">PKN Master</h1>
                    <p class="text-sm opacity-75">Desktop Version</p>
                </div>
            </div>
            
            <!-- Navigation Menu -->
            <nav class="space-y-2" id="desktopNavigation">
                <button onclick="showPage('home')" class="nav-item active w-full flex items-center space-x-3 px-4 py-3 rounded-xl hover:bg-white hover:bg-opacity-20 transition-all duration-300 desktop-focus tooltip" data-tooltip="Beranda (Alt+H)">
                    <span class="text-xl">🏠</span>
                    <span class="nav-text">Beranda</span>
                    <span class="keyboard-shortcut">Alt+H</span>
                </button>
                <button onclick="showPage('play')" class="nav-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl hover:bg-white hover:bg-opacity-20 transition-all duration-300 desktop-focus tooltip" data-tooltip="Main Game (Alt+P)">
                    <span class="text-xl">🎮</span>
                    <span class="nav-text">Main Game</span>
                    <span class="keyboard-shortcut">Alt+P</span>
                </button>
                <button onclick="showPage('tournament')" class="nav-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl hover:bg-white hover:bg-opacity-20 transition-all duration-300 desktop-focus tooltip" data-tooltip="Turnamen (Alt+T)">
                    <span class="text-xl">🏆</span>
                    <span class="nav-text">Turnamen</span>
                    <span class="keyboard-shortcut">Alt+T</span>
                </button>
                <button onclick="showPage('leaderboard')" class="nav-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl hover:bg-white hover:bg-opacity-20 transition-all duration-300 desktop-focus tooltip" data-tooltip="Papan Skor (Alt+L)">
                    <span class="text-xl">📊</span>
                    <span class="nav-text">Papan Skor</span>
                    <span class="keyboard-shortcut">Alt+L</span>
                </button>
                <button onclick="showPage('statistics')" class="nav-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl hover:bg-white hover:bg-opacity-20 transition-all duration-300 desktop-focus tooltip" data-tooltip="Statistik (Alt+S)">
                    <span class="text-xl">📈</span>
                    <span class="nav-text">Statistik</span>
                    <span class="keyboard-shortcut">Alt+S</span>
                </button>
                <button onclick="showPage('about')" class="nav-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl hover:bg-white hover:bg-opacity-20 transition-all duration-300 desktop-focus tooltip" data-tooltip="Tentang (Alt+A)">
                    <span class="text-xl">📖</span>
                    <span class="nav-text">Tentang</span>
                    <span class="keyboard-shortcut">Alt+A</span>
                </button>
            </nav>
            
            <!-- User Profile -->
            <div class="mt-8 pt-6 border-t border-white border-opacity-20" id="userProfile">
                <div class="flex items-center space-x-3 mb-4 cursor-pointer" onclick="showProfileModal()">
                    <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-xl" id="userAvatar">
                        👨‍🎓
                    </div>
                    <div class="nav-text">
                        <div class="font-semibold" id="userName">Guest Player</div>
                        <div class="text-sm opacity-75">Level <span id="userLevel">1</span></div>
                    </div>
                </div>
                <div class="space-y-2 nav-text">
                    <div class="flex justify-between text-sm">
                        <span>Poin:</span>
                        <span id="userPoints">0</span>
                    </div>
                    <div class="desktop-progress">
                        <div class="desktop-progress-fill" id="levelProgress" style="width: 0%"></div>
                    </div>
                </div>
                <button onclick="showLoginModal()" id="loginButton" class="w-full mt-4 px-4 py-2 bg-white bg-opacity-20 rounded-lg hover:bg-opacity-30 transition-all duration-300 text-sm font-medium">
                    🔐 Login / Daftar
                </button>
                <button onclick="logout()" id="logoutButton" class="w-full mt-4 px-4 py-2 bg-red-500 bg-opacity-80 rounded-lg hover:bg-opacity-100 transition-all duration-300 text-sm font-medium hidden">
                    🚪 Logout
                </button>
            </div>
            
            <!-- Sidebar Toggle -->
            <button onclick="toggleSidebar()" class="absolute top-6 right-4 w-8 h-8 bg-white bg-opacity-20 rounded-lg flex items-center justify-center hover:bg-opacity-30 transition-all duration-300 tooltip" data-tooltip="Toggle Sidebar (Ctrl+B)">
                <span id="sidebarToggleIcon">←</span>
            </button>
        </div>
    </div>
    
    <!-- Main Content Area -->
    <div id="desktopMainContent" class="desktop-main-content min-h-screen">
        <!-- Top Bar -->
        <div class="bg-white shadow-sm border-b border-gray-200 px-6 py-4 flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <button onclick="toggleMobileSidebar()" class="lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors duration-300">
                    <span class="text-xl">☰</span>
                </button>
                <div>
                    <h1 id="pageTitle" class="text-2xl font-bold text-gray-800">PKN Master</h1>
                    <p id="pageSubtitle" class="text-sm text-gray-600">Kuasai Pendidikan Kewarganegaraan dengan cara yang menyenangkan!</p>
                </div>
            </div>
            
            <div class="flex items-center space-x-4">
                <!-- Quick Actions -->
                <div class="flex items-center space-x-2">
                    <button onclick="showQuickPlay()" class="px-4 py-2 bg-primary text-white rounded-xl hover:bg-blue-600 transition-all duration-300 desktop-focus tooltip" data-tooltip="Quick Play (Space)">
                        🚀 Mulai Bermain
                    </button>
                    <button onclick="toggleFullscreen()" class="p-2 rounded-xl hover:bg-gray-100 transition-colors duration-300 desktop-focus tooltip" data-tooltip="Fullscreen (F11)">
                        <span class="text-xl" id="fullscreenIcon">⛶</span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Page Content -->
        <div class="p-6">
            <!-- Home Page -->
            <div id="homePage" class="page">
                <!-- Dashboard Stats -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="stats-card bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-xl">
                        <div class="flex items-center justify-between mb-4">
                            <div class="text-3xl">🎯</div>
                            <div class="text-right">
                                <div class="text-2xl font-bold" id="totalScore">0</div>
                                <div class="text-sm opacity-75">Total Skor</div>
                            </div>
                        </div>
                        <div class="desktop-progress">
                            <div class="desktop-progress-fill" style="width: 65%"></div>
                        </div>
                    </div>
                    
                    <div class="stats-card bg-gradient-to-br from-green-500 to-green-600 text-white p-6 rounded-xl">
                        <div class="flex items-center justify-between mb-4">
                            <div class="text-3xl">🏆</div>
                            <div class="text-right">
                                <div class="text-2xl font-bold" id="gamesWon">0</div>
                                <div class="text-sm opacity-75">Game Dimenangkan</div>
                            </div>
                        </div>
                        <div class="desktop-progress">
                            <div class="desktop-progress-fill" style="width: 45%"></div>
                        </div>
                    </div>
                    
                    <div class="stats-card bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-xl">
                        <div class="flex items-center justify-between mb-4">
                            <div class="text-3xl">📚</div>
                            <div class="text-right">
                                <div class="text-2xl font-bold" id="questionsAnswered">0</div>
                                <div class="text-sm opacity-75">Soal Dijawab</div>
                            </div>
                        </div>
                        <div class="desktop-progress">
                            <div class="desktop-progress-fill" style="width: 80%"></div>
                        </div>
                    </div>
                    
                    <div class="stats-card bg-gradient-to-br from-orange-500 to-orange-600 text-white p-6 rounded-xl">
                        <div class="flex items-center justify-between mb-4">
                            <div class="text-3xl">⚡</div>
                            <div class="text-right">
                                <div class="text-2xl font-bold" id="currentStreak">0</div>
                                <div class="text-sm opacity-75">Streak Saat Ini</div>
                            </div>
                        </div>
                        <div class="desktop-progress">
                            <div class="desktop-progress-fill" style="width: 30%"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Categories Grid -->
                <div class="window-panel p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Kategori Pembelajaran</h2>
                        <div class="text-sm text-gray-600">Pilih kategori untuk memulai quiz • Gunakan angka 1-6</div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="desktop-card bg-red-500 text-white rounded-xl p-6 cursor-pointer" onclick="startQuiz('pancasila')">
                            <div class="text-4xl mb-4">🇮🇩</div>
                            <h3 class="text-xl font-bold mb-2">Pancasila</h3>
                            <p class="text-sm opacity-90 mb-4">Nilai-nilai dasar bangsa Indonesia dan implementasinya</p>
                            <div class="flex items-center justify-between">
                                <span class="text-xs opacity-75">25+ soal tersedia</span>
                                <span class="keyboard-shortcut">1</span>
                            </div>
                        </div>
                        
                        <div class="desktop-card bg-blue-500 text-white rounded-xl p-6 cursor-pointer" onclick="startQuiz('konstitusi')">
                            <div class="text-4xl mb-4">📜</div>
                            <h3 class="text-xl font-bold mb-2">Konstitusi</h3>
                            <p class="text-sm opacity-90 mb-4">UUD 1945, amandemen, dan sistem hukum Indonesia</p>
                            <div class="flex items-center justify-between">
                                <span class="text-xs opacity-75">25+ soal tersedia</span>
                                <span class="keyboard-shortcut">2</span>
                            </div>
                        </div>
                        
                        <div class="desktop-card bg-green-500 text-white rounded-xl p-6 cursor-pointer" onclick="startQuiz('demokrasi')">
                            <div class="text-4xl mb-4">🗳️</div>
                            <h3 class="text-xl font-bold mb-2">Demokrasi</h3>
                            <p class="text-sm opacity-90 mb-4">Sistem pemerintahan dan partisipasi warga negara</p>
                            <div class="flex items-center justify-between">
                                <span class="text-xs opacity-75">25+ soal tersedia</span>
                                <span class="keyboard-shortcut">3</span>
                            </div>
                        </div>
                        
                        <div class="desktop-card bg-purple-500 text-white rounded-xl p-6 cursor-pointer" onclick="startQuiz('nkri')">
                            <div class="text-4xl mb-4">🏛️</div>
                            <h3 class="text-xl font-bold mb-2">NKRI</h3>
                            <p class="text-sm opacity-90 mb-4">Negara Kesatuan Republik Indonesia dan wilayahnya</p>
                            <div class="flex items-center justify-between">
                                <span class="text-xs opacity-75">25+ soal tersedia</span>
                                <span class="keyboard-shortcut">4</span>
                            </div>
                        </div>
                        
                        <div class="desktop-card bg-yellow-500 text-white rounded-xl p-6 cursor-pointer" onclick="startQuiz('bhinneka')">
                            <div class="text-4xl mb-4">🤝</div>
                            <h3 class="text-xl font-bold mb-2">Bhinneka Tunggal Ika</h3>
                            <p class="text-sm opacity-90 mb-4">Keberagaman dalam persatuan dan toleransi</p>
                            <div class="flex items-center justify-between">
                                <span class="text-xs opacity-75">25+ soal tersedia</span>
                                <span class="keyboard-shortcut">5</span>
                            </div>
                        </div>
                        
                        <div class="desktop-card bg-indigo-500 text-white rounded-xl p-6 cursor-pointer" onclick="startQuiz('ham')">
                            <div class="text-4xl mb-4">⚖️</div>
                            <h3 class="text-xl font-bold mb-2">HAM</h3>
                            <p class="text-sm opacity-90 mb-4">Hak Asasi Manusia dan perlindungannya</p>
                            <div class="flex items-center justify-between">
                                <span class="text-xs opacity-75">25+ soal tersedia</span>
                                <span class="keyboard-shortcut">6</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quiz Page -->
            <div id="quizPage" class="page hidden">
                <div class="max-w-5xl mx-auto">
                    <!-- Quiz Header -->
                    <div class="window-panel p-6 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <h2 class="text-3xl font-bold text-gray-800" id="quizCategory">Kategori Quiz</h2>
                                <p class="text-gray-600 text-lg">Soal <span id="currentQuestion">1</span> dari <span id="totalQuizQuestions">10</span></p>
                            </div>
                            <div class="flex items-center space-x-8">
                                <div class="text-center">
                                    <div class="text-4xl font-bold text-primary" id="quizTimer">30</div>
                                    <div class="text-sm text-gray-600">detik</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-4xl font-bold text-accent" id="currentScore">0</div>
                                    <div class="text-sm text-gray-600">poin</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-4xl font-bold text-secondary" id="streakDisplay">0</div>
                                    <div class="text-sm text-gray-600">streak</div>
                                </div>
                            </div>
                        </div>
                        <div class="desktop-progress">
                            <div class="desktop-progress-fill" id="progressBar" style="width: 10%"></div>
                        </div>
                    </div>
                    
                    <!-- Question Card -->
                    <div class="window-panel p-8 mb-6">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-8 leading-relaxed" id="questionText">Pertanyaan akan muncul di sini...</h3>
                        <div id="answerOptions" class="space-y-4">
                            <!-- Answer options will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Quiz Controls -->
                    <div class="flex justify-between items-center">
                        <button onclick="showPage('home')" class="px-8 py-4 bg-gray-500 text-white rounded-xl hover:bg-gray-600 transition-all duration-300 desktop-focus text-lg">
                            ← Kembali <span class="keyboard-shortcut ml-2">Esc</span>
                        </button>
                        <div class="text-sm text-gray-600">
                            Gunakan A, B, C, D untuk memilih jawaban • Enter untuk lanjut
                        </div>
                        <button id="nextButton" onclick="nextQuestion()" class="px-8 py-4 bg-primary text-white rounded-xl hover:bg-blue-600 transition-all duration-300 hidden desktop-focus text-lg">
                            Selanjutnya → <span class="keyboard-shortcut ml-2">Enter</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Play Page -->
            <div id="playPage" class="page hidden">
                <div class="max-w-4xl mx-auto">
                    <div class="window-panel p-8 text-center">
                        <div class="text-8xl mb-6">🎮</div>
                        <h2 class="text-4xl font-bold text-gray-800 mb-4">Mode Permainan</h2>
                        <p class="text-gray-600 mb-8 text-lg">Pilih mode permainan yang Anda inginkan</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <div class="desktop-card bg-gradient-to-br from-blue-500 to-blue-600 text-white p-8 rounded-xl cursor-pointer" onclick="showQuickPlay()">
                                <div class="text-5xl mb-4">⚡</div>
                                <h3 class="text-2xl font-bold mb-2">Quick Play</h3>
                                <p class="opacity-90 mb-4">Mainkan quiz acak dari semua kategori</p>
                                <div class="keyboard-shortcut bg-white bg-opacity-20">Space</div>
                            </div>
                            
                            <div class="desktop-card bg-gradient-to-br from-green-500 to-green-600 text-white p-8 rounded-xl cursor-pointer" onclick="showPage('home')">
                                <div class="text-5xl mb-4">📚</div>
                                <h3 class="text-2xl font-bold mb-2">Pilih Kategori</h3>
                                <p class="opacity-90 mb-4">Pilih kategori spesifik untuk dipelajari</p>
                                <div class="keyboard-shortcut bg-white bg-opacity-20">1-6</div>
                            </div>
                        </div>
                        
                        <button onclick="showQuickPlay()" class="px-12 py-4 bg-primary text-white rounded-xl hover:bg-blue-600 transition-all duration-300 desktop-focus text-xl">
                            🚀 Mulai Quick Play Sekarang
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Tournament Page -->
            <div id="tournamentPage" class="page hidden">
                <div class="max-w-4xl mx-auto">
                    <div class="window-panel p-8 text-center">
                        <div class="text-8xl mb-6">🏆</div>
                        <h2 class="text-4xl font-bold text-gray-800 mb-4">Turnamen PKN Master</h2>
                        <p class="text-gray-600 mb-8 text-lg">Kompetisi antar pemain se-Indonesia - Segera Hadir!</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-gradient-to-br from-yellow-400 to-yellow-600 text-white p-6 rounded-xl">
                                <div class="text-4xl mb-3">🥇</div>
                                <h3 class="text-xl font-bold mb-2">Juara 1</h3>
                                <p class="text-sm opacity-90">Hadiah Rp 5.000.000</p>
                            </div>
                            <div class="bg-gradient-to-br from-gray-300 to-gray-500 text-white p-6 rounded-xl">
                                <div class="text-4xl mb-3">🥈</div>
                                <h3 class="text-xl font-bold mb-2">Juara 2</h3>
                                <p class="text-sm opacity-90">Hadiah Rp 3.000.000</p>
                            </div>
                            <div class="bg-gradient-to-br from-yellow-600 to-yellow-800 text-white p-6 rounded-xl">
                                <div class="text-4xl mb-3">🥉</div>
                                <h3 class="text-xl font-bold mb-2">Juara 3</h3>
                                <p class="text-sm opacity-90">Hadiah Rp 1.000.000</p>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 p-6 rounded-xl">
                            <h3 class="text-xl font-bold text-blue-800 mb-2">📅 Jadwal Turnamen</h3>
                            <p class="text-blue-600">Turnamen akan dimulai setelah mencapai 1000 pemain aktif</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Leaderboard Page -->
            <div id="leaderboardPage" class="page hidden">
                <div class="max-w-4xl mx-auto">
                    <div class="window-panel p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-3xl font-bold text-gray-800">🏆 Papan Peringkat</h2>
                            <button onclick="updateLeaderboard()" class="px-4 py-2 bg-primary text-white rounded-xl hover:bg-blue-600 transition-all duration-300">
                                🔄 Refresh
                            </button>
                        </div>
                        <div class="space-y-3" id="leaderboardList">
                            <!-- Leaderboard will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Statistics Page -->
            <div id="statisticsPage" class="page hidden">
                <div class="max-w-6xl mx-auto">
                    <div class="window-panel p-6">
                        <h2 class="text-3xl font-bold text-gray-800 mb-8">📊 Statistik Permainan Anda</h2>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div class="text-center p-6 bg-blue-50 rounded-xl">
                                <div class="text-4xl font-bold text-blue-600 mb-2" id="statsAccuracy">0%</div>
                                <div class="text-gray-600">Tingkat Akurasi</div>
                            </div>
                            <div class="text-center p-6 bg-green-50 rounded-xl">
                                <div class="text-4xl font-bold text-green-600 mb-2" id="statsAvgTime">0s</div>
                                <div class="text-gray-600">Rata-rata Waktu</div>
                            </div>
                            <div class="text-center p-6 bg-purple-50 rounded-xl">
                                <div class="text-4xl font-bold text-purple-600 mb-2" id="statsBestStreak">0</div>
                                <div class="text-gray-600">Streak Terbaik</div>
                            </div>
                            <div class="text-center p-6 bg-orange-50 rounded-xl">
                                <div class="text-4xl font-bold text-orange-600 mb-2" id="statsPlayTime">0m</div>
                                <div class="text-gray-600">Total Waktu Bermain</div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="bg-white p-6 rounded-xl border">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">📈 Progress per Kategori</h3>
                                <div class="space-y-4" id="categoryProgress">
                                    <!-- Category progress will be populated by JavaScript -->
                                </div>
                            </div>
                            
                            <div class="bg-white p-6 rounded-xl border">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">🎯 Pencapaian</h3>
                                <div class="space-y-3" id="achievements">
                                    <!-- Achievements will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- About Page -->
            <div id="aboutPage" class="page hidden">
                <div class="max-w-5xl mx-auto">
                    <div class="window-panel p-8">
                        <div class="text-center mb-8">
                            <img src="pknmaster.png" alt="PKN Icon" class="w-[200px] h-[120px] mx-auto mb-6" />
                            <h2 class="text-4xl font-bold text-gray-800 mb-4">PKN Master</h2>
                            <p class="text-gray-600 text-xl">Desktop Optimized Version</p>
                            <p class="text-gray-500 mt-2">Platform pembelajaran PKN yang interaktif dan menyenangkan</p>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                            <div>
                                <h3 class="text-2xl font-bold text-gray-800 mb-4">🚀 Fitur Unggulan</h3>
                                <ul class="space-y-3 text-gray-600">
                                    <li class="flex items-center space-x-3">
                                        <span class="text-green-500">✓</span>
                                        <span>Quiz interaktif dengan 6 kategori lengkap</span>
                                    </li>
                                    <li class="flex items-center space-x-3">
                                        <span class="text-green-500">✓</span>
                                        <span>Sistem poin, level, dan streak tracking</span>
                                    </li>
                                    <li class="flex items-center space-x-3">
                                        <span class="text-green-500">✓</span>
                                        <span>Keyboard shortcuts untuk desktop</span>
                                    </li>
                                    <li class="flex items-center space-x-3">
                                        <span class="text-green-500">✓</span>
                                        <span>Animasi dan efek visual yang menarik</span>
                                    </li>
                                    <li class="flex items-center space-x-3">
                                        <span class="text-green-500">✓</span>
                                        <span>Progress tracking dan statistik detail</span>
                                    </li>
                                    <li class="flex items-center space-x-3">
                                        <span class="text-green-500">✓</span>
                                        <span>Responsive design untuk semua perangkat</span>
                                    </li>
                                    <li class="flex items-center space-x-3">
                                        <span class="text-green-500">✓</span>
                                        <span>Leaderboard dan sistem kompetisi</span>
                                    </li>
                                </ul>
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold text-gray-800 mb-4">⌨️ Keyboard Shortcuts</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                                        <span>Beranda</span>
                                        <kbd class="bg-gray-200 px-2 py-1 rounded text-xs">Alt+H</kbd>
                                    </div>
                                    <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                                        <span>Main Game</span>
                                        <kbd class="bg-gray-200 px-2 py-1 rounded text-xs">Alt+P</kbd>
                                    </div>
                                    <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                                        <span>Quick Play</span>
                                        <kbd class="bg-gray-200 px-2 py-1 rounded text-xs">Space</kbd>
                                    </div>
                                    <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                                        <span>Pilih Kategori</span>
                                        <kbd class="bg-gray-200 px-2 py-1 rounded text-xs">1-6</kbd>
                                    </div>
                                    <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                                        <span>Jawab Quiz</span>
                                        <kbd class="bg-gray-200 px-2 py-1 rounded text-xs">A-D</kbd>
                                    </div>
                                    <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                                        <span>Toggle Sidebar</span>
                                        <kbd class="bg-gray-200 px-2 py-1 rounded text-xs">Ctrl+B</kbd>
                                    </div>
                                    <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                                        <span>Fullscreen</span>
                                        <kbd class="bg-gray-200 px-2 py-1 rounded text-xs">F11</kbd>
                                    </div>
                                    <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                                        <span>Kembali/Tutup</span>
                                        <kbd class="bg-gray-200 px-2 py-1 rounded text-xs">Esc</kbd>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl">
                            <h3 class="text-xl font-bold text-gray-800 mb-2">📖 Tentang PKN Master</h3>
                            <p class="text-gray-600">
                                PKN Master adalah platform pembelajaran Pendidikan Kewarganegaraan yang dirancang khusus untuk membuat belajar menjadi lebih menyenangkan dan interaktif. 
                                Dengan sistem gamifikasi yang lengkap, siswa dapat belajar sambil bermain dan berkompetisi dengan teman-teman lainnya.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Desktop Modal for Quiz Results -->
    <div id="resultsModal" class="fixed inset-0 desktop-modal hidden items-center justify-center z-50">
        <div class="desktop-modal-content max-w-lg w-full mx-4 p-8 text-center">
            <div class="text-8xl mb-6" id="resultIcon">🎉</div>
            <h2 class="text-3xl font-bold mb-4 text-gray-800" id="resultTitle">Selamat!</h2>
            <div class="space-y-4 mb-8" id="resultStats">
                <div class="flex justify-between text-lg">
                    <span>Skor Akhir:</span>
                    <span class="font-bold text-primary" id="finalScore">0</span>
                </div>
                <div class="flex justify-between text-lg">
                    <span>Jawaban Benar:</span>
                    <span class="font-bold text-green-600" id="correctAnswers">0/10</span>
                </div>
                <div class="flex justify-between text-lg">
                    <span>Akurasi:</span>
                    <span class="font-bold text-blue-600" id="accuracy">0%</span>
                </div>
                <div class="flex justify-between text-lg">
                    <span>Waktu Total:</span>
                    <span class="font-bold text-orange-600" id="totalTime">0s</span>
                </div>
                <div class="flex justify-between text-lg">
                    <span>Streak Terbaik:</span>
                    <span class="font-bold text-purple-600" id="bestStreakResult">0</span>
                </div>
            </div>
            <div class="flex space-x-4">
                <button onclick="closeResults()" class="flex-1 px-6 py-3 bg-gray-500 text-white rounded-xl hover:bg-gray-600 transition-all duration-300 desktop-focus">
                    Tutup <span class="keyboard-shortcut ml-2">Esc</span>
                </button>
                <button onclick="playAgain()" class="flex-1 px-6 py-3 bg-primary text-white rounded-xl hover:bg-blue-600 transition-all duration-300 desktop-focus">
                    Main Lagi <span class="keyboard-shortcut ml-2">R</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 desktop-modal hidden items-center justify-center z-50">
        <div class="desktop-modal-content max-w-md w-full mx-4 p-8">
            <div class="text-center mb-6">
                <div class="text-6xl mb-4">🔐</div>
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Masuk ke PKN Master</h2>
                <p class="text-gray-600">Simpan progress dan bersaing dengan pemain lain</p>
            </div>
            
            <div class="space-y-6">
                <!-- Login Form -->
                <div id="loginForm">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email atau Username</label>
                            <input type="text" id="loginUsername" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent desktop-focus" placeholder="Masukkan email atau username">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                            <input type="password" id="loginPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent desktop-focus" placeholder="Masukkan password">
                        </div>
                        <div class="flex items-center justify-between">
                            <label class="flex items-center">
                                <input type="checkbox" id="rememberMe" class="rounded border-gray-300 text-primary focus:ring-primary">
                                <span class="ml-2 text-sm text-gray-600">Ingat saya</span>
                            </label>
                            <button class="text-sm text-primary hover:underline">Lupa password?</button>
                        </div>
                    </div>
                    
                    <div class="mt-6 space-y-3">
                        <button onclick="performLogin()" class="w-full px-6 py-3 bg-primary text-white rounded-xl hover:bg-blue-600 transition-all duration-300 desktop-focus font-medium">
                            🚀 Masuk Sekarang
                        </button>
                        <button onclick="showRegisterForm()" class="w-full px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 desktop-focus font-medium">
                            📝 Daftar Akun Baru
                        </button>
                    </div>
                </div>
                
                <!-- Register Form -->
                <div id="registerForm" class="hidden">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
                            <input type="text" id="registerName" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent desktop-focus" placeholder="Masukkan nama lengkap">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                            <input type="email" id="registerEmail" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent desktop-focus" placeholder="Masukkan email">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                            <input type="text" id="registerUsername" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent desktop-focus" placeholder="Pilih username">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Sekolah</label>
                            <input type="text" id="registerSchool" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent desktop-focus" placeholder="Nama sekolah">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                            <input type="password" id="registerPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent desktop-focus" placeholder="Buat password">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Konfirmasi Password</label>
                            <input type="password" id="confirmPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent desktop-focus" placeholder="Ulangi password">
                        </div>
                    </div>
                    
                    <div class="mt-6 space-y-3">
                        <button onclick="performRegister()" class="w-full px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-all duration-300 desktop-focus font-medium">
                            ✨ Daftar Sekarang
                        </button>
                        <button onclick="showLoginForm()" class="w-full px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-300 desktop-focus font-medium">
                            ← Kembali ke Login
                        </button>
                    </div>
                </div>
                
                <div class="text-center">
                    <button onclick="closeLoginModal()" class="text-gray-500 hover:text-gray-700 transition-colors duration-300">
                        Tutup <span class="keyboard-shortcut ml-2">Esc</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="fixed inset-0 desktop-modal hidden items-center justify-center z-50">
        <div class="desktop-modal-content max-w-lg w-full mx-4 p-8">
            <div class="text-center mb-6">
                <div class="w-20 h-20 bg-gradient-to-br from-primary to-purple-600 rounded-full flex items-center justify-center text-3xl mx-auto mb-4" id="profileAvatar">
                    👨‍🎓
                </div>
                <h2 class="text-3xl font-bold text-gray-800 mb-2" id="profileName">Guest Player</h2>
                <p class="text-gray-600" id="profileSchool">Local Player</p>
            </div>
            
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="text-center p-4 bg-blue-50 rounded-xl">
                    <div class="text-2xl font-bold text-blue-600" id="profileLevel">1</div>
                    <div class="text-sm text-gray-600">Level</div>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-xl">
                    <div class="text-2xl font-bold text-green-600" id="profileScore">0</div>
                    <div class="text-sm text-gray-600">Total Skor</div>
                </div>
                <div class="text-center p-4 bg-purple-50 rounded-xl">
                    <div class="text-2xl font-bold text-purple-600" id="profileAccuracy">0%</div>
                    <div class="text-sm text-gray-600">Akurasi</div>
                </div>
                <div class="text-center p-4 bg-orange-50 rounded-xl">
                    <div class="text-2xl font-bold text-orange-600" id="profileRank">#-</div>
                    <div class="text-sm text-gray-600">Peringkat</div>
                </div>
            </div>
            
            <div class="space-y-4 mb-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
                    <input type="text" id="editName" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent desktop-focus">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Sekolah</label>
                    <input type="text" id="editSchool" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent desktop-focus">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Avatar</label>
                    <div class="flex space-x-2">
                        <button onclick="changeAvatar('👨‍🎓')" class="p-3 border border-gray-300 rounded-xl hover:border-primary transition-colors duration-300 text-2xl">👨‍🎓</button>
                        <button onclick="changeAvatar('👩‍🎓')" class="p-3 border border-gray-300 rounded-xl hover:border-primary transition-colors duration-300 text-2xl">👩‍🎓</button>
                        <button onclick="changeAvatar('🧑‍💼')" class="p-3 border border-gray-300 rounded-xl hover:border-primary transition-colors duration-300 text-2xl">🧑‍💼</button>
                        <button onclick="changeAvatar('👨‍💻')" class="p-3 border border-gray-300 rounded-xl hover:border-primary transition-colors duration-300 text-2xl">👨‍💻</button>
                        <button onclick="changeAvatar('👩‍💻')" class="p-3 border border-gray-300 rounded-xl hover:border-primary transition-colors duration-300 text-2xl">👩‍💻</button>
                        <button onclick="changeAvatar('🎯')" class="p-3 border border-gray-300 rounded-xl hover:border-primary transition-colors duration-300 text-2xl">🎯</button>
                    </div>
                </div>
            </div>
            
            <div class="flex space-x-4">
                <button onclick="saveProfile()" class="flex-1 px-6 py-3 bg-primary text-white rounded-xl hover:bg-blue-600 transition-all duration-300 desktop-focus font-medium">
                    💾 Simpan Profil
                </button>
                <button onclick="closeProfileModal()" class="flex-1 px-6 py-3 bg-gray-500 text-white rounded-xl hover:bg-gray-600 transition-all duration-300 desktop-focus font-medium">
                    Tutup
                </button>
            </div>
        </div>
    </div>

    <script>
        // Desktop-Optimized PKN Master Games v7 - Complete Implementation
        class PKNMasterDesktop {
            constructor() {
                this.currentPage = 'home';
                this.sidebarCollapsed = false;
                this.isFullscreen = false;
                this.isLoggedIn = false;
                this.currentUser = {
                    id: null,
                    name: 'Guest Player',
                    username: '',
                    email: '',
                    school: 'Local Player',
                    avatar: '👨‍🎓',
                    joinDate: new Date().toISOString()
                };
                this.gameState = {
                    score: 0,
                    level: 1,
                    gamesWon: 0,
                    questionsAnswered: 0,
                    currentStreak: 0,
                    totalScore: 0,
                    bestStreak: 0,
                    totalTime: 0,
                    correctAnswers: 0,
                    playTime: 0,
                    categoryStats: {
                        pancasila: { played: 0, correct: 0 },
                        konstitusi: { played: 0, correct: 0 },
                        demokrasi: { played: 0, correct: 0 },
                        nkri: { played: 0, correct: 0 },
                        bhinneka: { played: 0, correct: 0 },
                        ham: { played: 0, correct: 0 }
                    }
                };
                this.currentQuiz = {
                    category: '',
                    questions: [],
                    currentIndex: 0,
                    score: 0,
                    timeLeft: 30,
                    timer: null,
                    startTime: 0,
                    correctCount: 0,
                    streak: 0
                };
                this.leaderboard = [];
                this.achievements = [];
                this.users = [];
                this.init();
            }

            init() {
                this.setupKeyboardShortcuts();
                this.loadUsers();
                this.loadCurrentUser();
                this.loadGameState();
                this.loadLeaderboard();
                this.updateUI();
                this.setupQuestions();
                this.initializeAchievements();
                this.updateLoginState();
                console.log('PKN Master initialized successfully!');
            }

            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    // Handle Alt key combinations for navigation
                    if (e.altKey) {
                        switch(e.key.toLowerCase()) {
                            case 'h':
                                e.preventDefault();
                                this.showPage('home');
                                break;
                            case 'p':
                                e.preventDefault();
                                this.showPage('play');
                                break;
                            case 't':
                                e.preventDefault();
                                this.showPage('tournament');
                                break;
                            case 'l':
                                e.preventDefault();
                                this.showPage('leaderboard');
                                break;
                            case 's':
                                e.preventDefault();
                                this.showPage('statistics');
                                break;
                            case 'a':
                                e.preventDefault();
                                this.showPage('about');
                                break;
                        }
                    }
                    
                    // Handle Ctrl key combinations
                    if (e.ctrlKey) {
                        switch(e.key.toLowerCase()) {
                            case 'b':
                                e.preventDefault();
                                this.toggleSidebar();
                                break;
                        }
                    }
                    
                    // Handle single key shortcuts
                    if (!e.ctrlKey && !e.altKey && !e.shiftKey) {
                        switch(e.key.toLowerCase()) {
                            case ' ':
                                if (document.activeElement.tagName !== 'INPUT') {
                                    e.preventDefault();
                                    this.showQuickPlay();
                                }
                                break;
                            case 'escape':
                                this.handleEscape();
                                break;
                            case 'f11':
                                e.preventDefault();
                                this.toggleFullscreen();
                                break;
                            case 'enter':
                                if (this.currentPage === 'quiz') {
                                    const nextBtn = document.getElementById('nextButton');
                                    if (!nextBtn.classList.contains('hidden')) {
                                        this.nextQuestion();
                                    }
                                }
                                break;
                            case 'r':
                                if (document.getElementById('resultsModal').classList.contains('flex')) {
                                    this.playAgain();
                                }
                                break;
                        }
                        
                        // Handle number keys for categories (1-6)
                        if (e.key >= '1' && e.key <= '6' && document.activeElement.tagName !== 'INPUT') {
                            const categories = ['pancasila', 'konstitusi', 'demokrasi', 'nkri', 'bhinneka', 'ham'];
                            const categoryIndex = parseInt(e.key) - 1;
                            if (categories[categoryIndex] && this.currentPage === 'home') {
                                this.startQuiz(categories[categoryIndex]);
                            }
                        }
                        
                        // Handle A, B, C, D for quiz answers
                        if (['a', 'b', 'c', 'd'].includes(e.key) && this.currentPage === 'quiz') {
                            const optionIndex = e.key.charCodeAt(0) - 97; // Convert a-d to 0-3
                            const options = document.querySelectorAll('.desktop-quiz-option');
                            if (options[optionIndex] && !options[optionIndex].classList.contains('disabled')) {
                                options[optionIndex].click();
                            }
                        }
                    }
                });
            }

            setupQuestions() {
                this.questions = {
                    pancasila: [
                        {
                            question: "Apa sila pertama dalam Pancasila?",
                            options: ["Ketuhanan Yang Maha Esa", "Kemanusiaan yang Adil dan Beradab", "Persatuan Indonesia", "Kerakyatan yang Dipimpin oleh Hikmat"],
                            correct: 0
                        },
                        {
                            question: "Lambang sila kedua Pancasila adalah?",
                            options: ["Bintang", "Rantai", "Pohon Beringin", "Kepala Banteng"],
                            correct: 1
                        },
                        {
                            question: "Pancasila sebagai dasar negara disahkan pada tanggal?",
                            options: ["17 Agustus 1945", "18 Agustus 1945", "1 Juni 1945", "22 Juni 1945"],
                            correct: 1
                        },
                        {
                            question: "Sila ketiga Pancasila mengandung nilai?",
                            options: ["Religius", "Humanis", "Nasionalisme", "Demokrasi"],
                            correct: 2
                        },
                        {
                            question: "Lambang sila keempat Pancasila adalah?",
                            options: ["Bintang", "Rantai", "Pohon Beringin", "Kepala Banteng"],
                            correct: 3
                        },
                        {
                            question: "Sila kelima Pancasila berbunyi?",
                            options: ["Keadilan sosial bagi seluruh rakyat Indonesia", "Persatuan Indonesia", "Kemanusiaan yang adil dan beradab", "Ketuhanan Yang Maha Esa"],
                            correct: 0
                        },
                        {
                            question: "Pancasila berfungsi sebagai?",
                            options: ["Dasar negara", "Ideologi negara", "Pandangan hidup bangsa", "Semua benar"],
                            correct: 3
                        },
                        {
                            question: "Nilai-nilai Pancasila harus diamalkan dalam?",
                            options: ["Kehidupan sehari-hari", "Kehidupan berbangsa", "Kehidupan bernegara", "Semua benar"],
                            correct: 3
                        }
                    ],
                    konstitusi: [
                        {
                            question: "UUD 1945 terdiri dari berapa pasal sebelum amandemen?",
                            options: ["37 pasal", "73 pasal", "45 pasal", "27 pasal"],
                            correct: 0
                        },
                        {
                            question: "Amandemen UUD 1945 dilakukan sebanyak?",
                            options: ["3 kali", "4 kali", "5 kali", "2 kali"],
                            correct: 1
                        },
                        {
                            question: "Lembaga yang berwenang mengubah UUD adalah?",
                            options: ["DPR", "MPR", "DPD", "Presiden"],
                            correct: 1
                        },
                        {
                            question: "Pasal berapa yang mengatur tentang HAM?",
                            options: ["Pasal 27", "Pasal 28", "Pasal 29", "Pasal 30"],
                            correct: 1
                        },
                        {
                            question: "Sistem pemerintahan Indonesia menurut UUD 1945 adalah?",
                            options: ["Parlementer", "Presidensial", "Campuran", "Federal"],
                            correct: 1
                        },
                        {
                            question: "UUD 1945 disahkan pada tanggal?",
                            options: ["17 Agustus 1945", "18 Agustus 1945", "19 Agustus 1945", "20 Agustus 1945"],
                            correct: 1
                        },
                        {
                            question: "Amandemen pertama UUD 1945 dilakukan pada tahun?",
                            options: ["1999", "2000", "2001", "2002"],
                            correct: 0
                        },
                        {
                            question: "Pembukaan UUD 1945 terdiri dari berapa alinea?",
                            options: ["3 alinea", "4 alinea", "5 alinea", "6 alinea"],
                            correct: 1
                        }
                    ],
                    demokrasi: [
                        {
                            question: "Demokrasi berasal dari kata Yunani 'demos' yang berarti?",
                            options: ["Pemerintahan", "Rakyat", "Kekuasaan", "Negara"],
                            correct: 1
                        },
                        {
                            question: "Pemilu di Indonesia dilaksanakan setiap?",
                            options: ["4 tahun", "5 tahun", "6 tahun", "3 tahun"],
                            correct: 1
                        },
                        {
                            question: "Asas pemilu yang berarti rahasia adalah?",
                            options: ["Luber", "Jurdil", "Langsung", "Bebas"],
                            correct: 0
                        },
                        {
                            question: "Lembaga yang menyelenggarakan pemilu adalah?",
                            options: ["KPU", "Bawaslu", "DKPP", "KPK"],
                            correct: 0
                        },
                        {
                            question: "Usia minimal untuk memilih dalam pemilu adalah?",
                            options: ["17 tahun", "18 tahun", "21 tahun", "16 tahun"],
                            correct: 0
                        },
                        {
                            question: "Demokrasi Pancasila mengutamakan?",
                            options: ["Kebebasan individu", "Musyawarah mufakat", "Mayoritas mutlak", "Kekuasaan elite"],
                            correct: 1
                        },
                        {
                            question: "Prinsip demokrasi yang paling penting adalah?",
                            options: ["Kedaulatan rakyat", "Kekuasaan mayoritas", "Kebebasan pers", "Pemilu rutin"],
                            correct: 0
                        },
                        {
                            question: "Dalam demokrasi, kekuasaan tertinggi berada di tangan?",
                            options: ["Presiden", "DPR", "Rakyat", "Mahkamah Agung"],
                            correct: 2
                        }
                    ],
                    nkri: [
                        {
                            question: "NKRI adalah singkatan dari?",
                            options: ["Negara Kesatuan Republik Indonesia", "Negara Kebangsaan Republik Indonesia", "Negara Konstitusi Republik Indonesia", "Negara Kedaulatan Republik Indonesia"],
                            correct: 0
                        },
                        {
                            question: "Bentuk negara Indonesia adalah?",
                            options: ["Federal", "Kesatuan", "Konfederasi", "Serikat"],
                            correct: 1
                        },
                        {
                            question: "Wilayah NKRI terdiri dari?",
                            options: ["Darat saja", "Darat dan laut", "Darat, laut, dan udara", "Laut dan udara"],
                            correct: 2
                        },
                        {
                            question: "Batas wilayah laut teritorial Indonesia adalah?",
                            options: ["12 mil laut", "200 mil laut", "24 mil laut", "100 mil laut"],
                            correct: 0
                        },
                        {
                            question: "Indonesia memiliki berapa provinsi saat ini?",
                            options: ["33", "34", "35", "38"],
                            correct: 3
                        },
                        {
                            question: "Ibu kota Indonesia adalah?",
                            options: ["Jakarta", "Surabaya", "Bandung", "Nusantara"],
                            correct: 0
                        },
                        {
                            question: "Indonesia terletak di antara dua benua yaitu?",
                            options: ["Asia dan Afrika", "Asia dan Australia", "Australia dan Amerika", "Asia dan Eropa"],
                            correct: 1
                        },
                        {
                            question: "Jumlah pulau di Indonesia sekitar?",
                            options: ["13.000", "17.000", "15.000", "20.000"],
                            correct: 1
                        }
                    ],
                    bhinneka: [
                        {
                            question: "Bhinneka Tunggal Ika berasal dari bahasa?",
                            options: ["Sansekerta", "Jawa Kuno", "Latin", "Arab"],
                            correct: 1
                        },
                        {
                            question: "Arti Bhinneka Tunggal Ika adalah?",
                            options: ["Berbeda-beda tetapi tetap satu", "Bersatu kita teguh", "Satu untuk semua", "Berbeda dalam persatuan"],
                            correct: 0
                        },
                        {
                            question: "Bhinneka Tunggal Ika terdapat dalam kitab?",
                            options: ["Sutasoma", "Arjunawiwaha", "Bharatayuddha", "Ramayana"],
                            correct: 0
                        },
                        {
                            question: "Indonesia memiliki berapa suku bangsa?",
                            options: ["300+", "500+", "700+", "1000+"],
                            correct: 2
                        },
                        {
                            question: "Keberagaman Indonesia meliputi?",
                            options: ["Suku saja", "Agama saja", "Suku, agama, bahasa, budaya", "Bahasa saja"],
                            correct: 2
                        },
                        {
                            question: "Sikap yang tepat terhadap keberagaman adalah?",
                            options: ["Toleransi", "Diskriminasi", "Fanatisme", "Individualisme"],
                            correct: 0
                        },
                        {
                            question: "Bahasa persatuan Indonesia adalah?",
                            options: ["Bahasa Jawa", "Bahasa Indonesia", "Bahasa Melayu", "Bahasa Sunda"],
                            correct: 1
                        },
                        {
                            question: "Semboyan Bhinneka Tunggal Ika mengajarkan?",
                            options: ["Persatuan dalam keberagaman", "Keseragaman budaya", "Dominasi mayoritas", "Pemisahan kelompok"],
                            correct: 0
                        }
                    ],
                    ham: [
                        {
                            question: "HAM adalah singkatan dari?",
                            options: ["Hak Asasi Manusia", "Hak Azasi Manusia", "Hak Absolut Manusia", "Hak Alamiah Manusia"],
                            correct: 0
                        },
                        {
                            question: "Komnas HAM dibentuk pada tahun?",
                            options: ["1993", "1998", "1999", "2000"],
                            correct: 0
                        },
                        {
                            question: "Hak untuk hidup termasuk dalam HAM?",
                            options: ["Sipil dan politik", "Ekonomi dan sosial", "Budaya", "Lingkungan"],
                            correct: 0
                        },
                        {
                            question: "Deklarasi Universal HAM ditetapkan pada tahun?",
                            options: ["1945", "1948", "1950", "1955"],
                            correct: 1
                        },
                        {
                            question: "Pengadilan HAM di Indonesia berada di?",
                            options: ["Jakarta", "Surabaya", "Jakarta dan Makassar", "Semua kota besar"],
                            correct: 2
                        },
                        {
                            question: "HAM bersifat?",
                            options: ["Universal", "Relatif", "Terbatas", "Kondisional"],
                            correct: 0
                        },
                        {
                            question: "Hak untuk mendapat pendidikan termasuk HAM?",
                            options: ["Sipil", "Politik", "Ekonomi, sosial, budaya", "Lingkungan"],
                            correct: 2
                        },
                        {
                            question: "Pelanggaran HAM berat meliputi?",
                            options: ["Genosida dan kejahatan kemanusiaan", "Pencurian", "Penipuan", "Pelanggaran lalu lintas"],
                            correct: 0
                        }
                    ]
                };
            }

            initializeAchievements() {
                this.achievements = [
                    { id: 'first_quiz', name: 'Quiz Pertama', description: 'Menyelesaikan quiz pertama', icon: '🎯', unlocked: false },
                    { id: 'streak_5', name: 'Streak Master', description: 'Mencapai streak 5', icon: '🔥', unlocked: false },
                    { id: 'perfect_score', name: 'Sempurna', description: 'Mendapat skor 100% dalam satu quiz', icon: '⭐', unlocked: false },
                    { id: 'speed_demon', name: 'Kilat', description: 'Menjawab dalam waktu kurang dari 10 detik', icon: '⚡', unlocked: false },
                    { id: 'all_categories', name: 'Ahli PKN', description: 'Menyelesaikan quiz di semua kategori', icon: '🏆', unlocked: false },
                    { id: 'high_scorer', name: 'Pencetak Skor', description: 'Mencapai total skor 10,000', icon: '💎', unlocked: false }
                ];
            }

            showPage(page) {
                // Hide all pages
                document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
                
                // Show selected page
                const pageElement = document.getElementById(page + 'Page');
                if (pageElement) {
                    pageElement.classList.remove('hidden');
                    this.currentPage = page;
                    
                    // Update navigation active state
                    document.querySelectorAll('.nav-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // Update page title
                    this.updatePageTitle(page);
                    
                    // Add active state to current nav item
                    const navItems = document.querySelectorAll('.nav-item');
                    const pageIndex = ['home', 'play', 'tournament', 'leaderboard', 'statistics', 'about'].indexOf(page);
                    if (navItems[pageIndex]) {
                        navItems[pageIndex].classList.add('active');
                    }
                    
                    // Load page-specific content
                    if (page === 'leaderboard') {
                        this.updateLeaderboard();
                    } else if (page === 'statistics') {
                        this.updateStatistics();
                    }
                }
            }

            updatePageTitle(page) {
                const titles = {
                    home: { title: 'Dashboard PKN Master', subtitle: 'Selamat datang di platform pembelajaran interaktif' },
                    play: { title: 'Mode Permainan', subtitle: 'Pilih cara bermain yang Anda sukai' },
                    tournament: { title: 'Turnamen PKN Master', subtitle: 'Kompetisi antar pemain se-Indonesia' },
                    leaderboard: { title: 'Papan Peringkat', subtitle: 'Pemain terbaik PKN Master' },
                    statistics: { title: 'Statistik Permainan', subtitle: 'Analisis performa dan progress Anda' },
                    about: { title: 'Tentang PKN Master', subtitle: 'Informasi lengkap tentang platform pembelajaran' }
                };

                const pageInfo = titles[page] || { title: 'PKN Master', subtitle: 'Platform pembelajaran interaktif' };
                document.getElementById('pageTitle').textContent = pageInfo.title;
                document.getElementById('pageSubtitle').textContent = pageInfo.subtitle;
            }

            toggleSidebar() {
                const sidebar = document.getElementById('desktopSidebar');
                const mainContent = document.getElementById('desktopMainContent');
                const toggleIcon = document.getElementById('sidebarToggleIcon');
                const navTexts = document.querySelectorAll('.nav-text');
                const sidebarTitle = document.getElementById('sidebarTitle');
                const shortcuts = document.querySelectorAll('.keyboard-shortcut');

                this.sidebarCollapsed = !this.sidebarCollapsed;

                if (this.sidebarCollapsed) {
                    sidebar.classList.add('collapsed');
                    mainContent.classList.add('expanded');
                    toggleIcon.textContent = '→';
                    
                    // Hide text elements with animation
                    navTexts.forEach(text => text.style.opacity = '0');
                    sidebarTitle.style.opacity = '0';
                    shortcuts.forEach(shortcut => shortcut.style.opacity = '0');
                    
                    setTimeout(() => {
                        navTexts.forEach(text => text.style.display = 'none');
                        sidebarTitle.style.display = 'none';
                        shortcuts.forEach(shortcut => shortcut.style.display = 'none');
                    }, 300);
                } else {
                    sidebar.classList.remove('collapsed');
                    mainContent.classList.remove('expanded');
                    toggleIcon.textContent = '←';
                    
                    // Show text elements with animation
                    navTexts.forEach(text => {
                        text.style.display = 'block';
                        setTimeout(() => text.style.opacity = '1', 50);
                    });
                    sidebarTitle.style.display = 'block';
                    setTimeout(() => sidebarTitle.style.opacity = '1', 50);
                    shortcuts.forEach(shortcut => {
                        shortcut.style.display = 'inline-flex';
                        setTimeout(() => shortcut.style.opacity = '1', 50);
                    });
                }
            }

            toggleMobileSidebar() {
                const sidebar = document.getElementById('desktopSidebar');
                sidebar.classList.toggle('mobile-open');
            }

            toggleFullscreen() {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().then(() => {
                        this.isFullscreen = true;
                        document.getElementById('fullscreenIcon').textContent = '⛶';
                    });
                } else {
                    document.exitFullscreen().then(() => {
                        this.isFullscreen = false;
                        document.getElementById('fullscreenIcon').textContent = '⛶';
                    });
                }
            }

            loadGameState() {
                const stateKey = this.isLoggedIn ? `pknMasterState_${this.currentUser.id}` : 'pknMasterDesktopState';
                const saved = localStorage.getItem(stateKey);
                if (saved) {
                    const savedState = JSON.parse(saved);
                    this.gameState = { ...this.gameState, ...savedState };
                }
            }

            saveGameState() {
                const stateKey = this.isLoggedIn ? `pknMasterState_${this.currentUser.id}` : 'pknMasterDesktopState';
                localStorage.setItem(stateKey, JSON.stringify(this.gameState));
            }

            loadLeaderboard() {
                const saved = localStorage.getItem('pknMasterLeaderboard');
                if (saved) {
                    this.leaderboard = JSON.parse(saved);
                } else {
                    // Initialize with sample data
                    this.leaderboard = [
                        { name: 'Ahmad Rizki S.', school: 'SMAN 1 Bandung', score: 28950, accuracy: 92 },
                        { name: 'Siti Nurhaliza', school: 'SMAN 3 Jakarta', score: 27800, accuracy: 89 },
                        { name: 'Budi Santoso', school: 'SMAN 2 Surabaya', score: 26500, accuracy: 87 },
                        { name: 'Dewi Lestari', school: 'SMAN 1 Yogyakarta', score: 25200, accuracy: 85 },
                        { name: 'Andi Pratama', school: 'SMAN 5 Medan', score: 24100, accuracy: 83 },
                        { name: 'Maya Sari', school: 'SMAN 4 Makassar', score: 23500, accuracy: 81 },
                        { name: 'Rudi Hermawan', school: 'SMAN 2 Semarang', score: 22800, accuracy: 79 },
                        { name: 'Indira Putri', school: 'SMAN 1 Denpasar', score: 22100, accuracy: 77 }
                    ];
                }
            }

            saveLeaderboard() {
                localStorage.setItem('pknMasterLeaderboard', JSON.stringify(this.leaderboard));
            }

            updateUI() {
                // Update main stats
                document.getElementById('totalScore').textContent = this.gameState.totalScore.toLocaleString();
                document.getElementById('gamesWon').textContent = this.gameState.gamesWon.toLocaleString();
                document.getElementById('questionsAnswered').textContent = this.gameState.questionsAnswered.toLocaleString();
                document.getElementById('currentStreak').textContent = this.gameState.currentStreak.toLocaleString();
                document.getElementById('userLevel').textContent = this.gameState.level;
                document.getElementById('userPoints').textContent = this.gameState.score.toLocaleString();

                // Update level progress
                const levelProgress = (this.gameState.score % 1000) / 10;
                document.getElementById('levelProgress').style.width = levelProgress + '%';

                // Check for achievements
                this.checkAchievements();
            }

            checkAchievements() {
                // First quiz achievement
                if (this.gameState.gamesWon >= 1 && !this.achievements.find(a => a.id === 'first_quiz').unlocked) {
                    this.unlockAchievement('first_quiz');
                }

                // Streak achievement
                if (this.gameState.bestStreak >= 5 && !this.achievements.find(a => a.id === 'streak_5').unlocked) {
                    this.unlockAchievement('streak_5');
                }

                // High scorer achievement
                if (this.gameState.totalScore >= 10000 && !this.achievements.find(a => a.id === 'high_scorer').unlocked) {
                    this.unlockAchievement('high_scorer');
                }

                // All categories achievement
                const allCategoriesPlayed = Object.values(this.gameState.categoryStats).every(stat => stat.played > 0);
                if (allCategoriesPlayed && !this.achievements.find(a => a.id === 'all_categories').unlocked) {
                    this.unlockAchievement('all_categories');
                }
            }

            unlockAchievement(achievementId) {
                const achievement = this.achievements.find(a => a.id === achievementId);
                if (achievement) {
                    achievement.unlocked = true;
                    this.showAchievementNotification(achievement);
                }
            }

            showAchievementNotification(achievement) {
                // Create achievement notification
                const notification = document.createElement('div');
                notification.className = 'fixed top-4 right-4 bg-gradient-to-r from-yellow-400 to-yellow-600 text-white p-4 rounded-xl shadow-lg z-50 transform translate-x-full transition-transform duration-300';
                notification.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <div class="text-2xl">${achievement.icon}</div>
                        <div>
                            <div class="font-bold">Pencapaian Baru!</div>
                            <div class="text-sm">${achievement.name}</div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // Animate in
                setTimeout(() => {
                    notification.classList.remove('translate-x-full');
                }, 100);
                
                // Animate out after 3 seconds
                setTimeout(() => {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }

            updateLeaderboard() {
                const leaderboardList = document.getElementById('leaderboardList');
                leaderboardList.innerHTML = '';

                this.leaderboard.forEach((player, index) => {
                    const position = index + 1;
                    let bgClass = 'bg-white border border-gray-200';
                    let icon = '👤';
                    
                    if (position === 1) {
                        bgClass = 'bg-gradient-to-r from-yellow-400 to-yellow-600 text-white';
                        icon = '👑';
                    } else if (position === 2) {
                        bgClass = 'bg-gradient-to-r from-gray-300 to-gray-500 text-white';
                        icon = '🥈';
                    } else if (position === 3) {
                        bgClass = 'bg-gradient-to-r from-yellow-600 to-yellow-800 text-white';
                        icon = '🥉';
                    }

                    const row = document.createElement('div');
                    row.className = `leaderboard-row ${bgClass}`;
                    row.innerHTML = `
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <div class="text-3xl">${icon}</div>
                                <div class="text-2xl font-bold">#${position}</div>
                                <div>
                                    <div class="font-bold text-lg">${player.name}</div>
                                    <div class="text-sm opacity-75">${player.school}</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-2xl font-bold">${player.score.toLocaleString()}</div>
                                <div class="text-sm opacity-75">${player.accuracy}% akurasi</div>
                            </div>
                        </div>
                    `;
                    leaderboardList.appendChild(row);
                });
            }

            updateStatistics() {
                const accuracy = this.gameState.questionsAnswered > 0 ? 
                    Math.round((this.gameState.correctAnswers / this.gameState.questionsAnswered) * 100) : 0;
                const avgTime = this.gameState.questionsAnswered > 0 ? 
                    Math.round(this.gameState.totalTime / this.gameState.questionsAnswered) : 0;
                const playTimeMinutes = Math.round(this.gameState.playTime / 60);

                document.getElementById('statsAccuracy').textContent = accuracy + '%';
                document.getElementById('statsAvgTime').textContent = avgTime + 's';
                document.getElementById('statsBestStreak').textContent = this.gameState.bestStreak;
                document.getElementById('statsPlayTime').textContent = playTimeMinutes + 'm';

                // Update category progress
                this.updateCategoryProgress();
                
                // Update achievements display
                this.updateAchievementsDisplay();
            }

            updateCategoryProgress() {
                const categoryProgress = document.getElementById('categoryProgress');
                categoryProgress.innerHTML = '';

                const categoryNames = {
                    pancasila: 'Pancasila',
                    konstitusi: 'Konstitusi', 
                    demokrasi: 'Demokrasi',
                    nkri: 'NKRI',
                    bhinneka: 'Bhinneka Tunggal Ika',
                    ham: 'HAM'
                };

                Object.entries(this.gameState.categoryStats).forEach(([category, stats]) => {
                    const accuracy = stats.played > 0 ? Math.round((stats.correct / stats.played) * 100) : 0;
                    const progressDiv = document.createElement('div');
                    progressDiv.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg';
                    progressDiv.innerHTML = `
                        <div>
                            <div class="font-semibold">${categoryNames[category]}</div>
                            <div class="text-sm text-gray-600">${stats.played} soal dijawab</div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-lg">${accuracy}%</div>
                            <div class="text-sm text-gray-600">akurasi</div>
                        </div>
                    `;
                    categoryProgress.appendChild(progressDiv);
                });
            }

            updateAchievementsDisplay() {
                const achievementsContainer = document.getElementById('achievements');
                achievementsContainer.innerHTML = '';

                this.achievements.forEach(achievement => {
                    const achievementDiv = document.createElement('div');
                    achievementDiv.className = `flex items-center space-x-3 p-3 rounded-lg ${achievement.unlocked ? 'bg-green-50 border border-green-200' : 'bg-gray-50 border border-gray-200'}`;
                    achievementDiv.innerHTML = `
                        <div class="text-2xl ${achievement.unlocked ? '' : 'grayscale opacity-50'}">${achievement.icon}</div>
                        <div class="flex-1">
                            <div class="font-semibold ${achievement.unlocked ? 'text-green-800' : 'text-gray-600'}">${achievement.name}</div>
                            <div class="text-sm ${achievement.unlocked ? 'text-green-600' : 'text-gray-500'}">${achievement.description}</div>
                        </div>
                        ${achievement.unlocked ? '<div class="text-green-500 font-bold">✓</div>' : '<div class="text-gray-400">🔒</div>'}
                    `;
                    achievementsContainer.appendChild(achievementDiv);
                });
            }

            // Quiz Functions
            startQuiz(category) {
                this.currentQuiz.category = category;
                this.currentQuiz.questions = [...this.questions[category]].sort(() => Math.random() - 0.5).slice(0, 10);
                this.currentQuiz.currentIndex = 0;
                this.currentQuiz.score = 0;
                this.currentQuiz.correctCount = 0;
                this.currentQuiz.streak = 0;
                this.currentQuiz.startTime = Date.now();
                
                this.showPage('quiz');
                this.displayQuestion();
                this.startTimer();
                
                // Update quiz header
                const categoryNames = {
                    pancasila: 'Pancasila',
                    konstitusi: 'Konstitusi',
                    demokrasi: 'Demokrasi',
                    nkri: 'NKRI',
                    bhinneka: 'Bhinneka Tunggal Ika',
                    ham: 'HAM'
                };
                document.getElementById('quizCategory').textContent = categoryNames[category];
                document.getElementById('totalQuizQuestions').textContent = this.currentQuiz.questions.length;
            }

            displayQuestion() {
                const question = this.currentQuiz.questions[this.currentQuiz.currentIndex];
                const currentQuestionNum = this.currentQuiz.currentIndex + 1;
                
                document.getElementById('currentQuestion').textContent = currentQuestionNum;
                document.getElementById('questionText').textContent = question.question;
                document.getElementById('currentScore').textContent = this.currentQuiz.score;
                document.getElementById('streakDisplay').textContent = this.currentQuiz.streak;
                
                // Update progress bar
                const progress = (currentQuestionNum / this.currentQuiz.questions.length) * 100;
                document.getElementById('progressBar').style.width = progress + '%';
                
                // Display answer options
                const optionsContainer = document.getElementById('answerOptions');
                optionsContainer.innerHTML = '';
                
                question.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.className = 'desktop-quiz-option w-full p-6 text-left border-2 border-gray-200 rounded-xl hover:border-primary transition-all duration-300';
                    button.innerHTML = `
                        <div class="flex items-center space-x-4">
                            <div class="w-10 h-10 bg-primary text-white rounded-full flex items-center justify-center font-bold text-lg">
                                ${String.fromCharCode(65 + index)}
                            </div>
                            <span class="text-lg">${option}</span>
                        </div>
                    `;
                    button.onclick = () => this.selectAnswer(index);
                    optionsContainer.appendChild(button);
                });
                
                // Reset timer
                this.currentQuiz.timeLeft = 30;
                document.getElementById('quizTimer').textContent = this.currentQuiz.timeLeft;
                document.getElementById('quizTimer').classList.remove('timer-warning');
                
                // Hide next button
                document.getElementById('nextButton').classList.add('hidden');
            }

            selectAnswer(selectedIndex) {
                const question = this.currentQuiz.questions[this.currentQuiz.currentIndex];
                const options = document.querySelectorAll('.desktop-quiz-option');
                const isCorrect = selectedIndex === question.correct;
                
                // Disable all options
                options.forEach(option => option.classList.add('disabled'));
                
                // Show correct/incorrect
                options[selectedIndex].classList.add(isCorrect ? 'correct' : 'incorrect');
                if (!isCorrect) {
                    options[question.correct].classList.add('correct');
                }
                
                // Update score and stats
                if (isCorrect) {
                    const timeBonus = Math.max(0, this.currentQuiz.timeLeft - 10);
                    const points = 100 + timeBonus * 3;
                    this.currentQuiz.score += points;
                    this.currentQuiz.correctCount++;
                    this.currentQuiz.streak++;
                    this.gameState.currentStreak++;
                    this.gameState.correctAnswers++;
                    
                    // Check for speed achievement
                    if (this.currentQuiz.timeLeft > 20 && !this.achievements.find(a => a.id === 'speed_demon').unlocked) {
                        this.unlockAchievement('speed_demon');
                    }
                    
                    // Celebration effect
                    options[selectedIndex].classList.add('celebrate');
                } else {
                    this.currentQuiz.streak = 0;
                    this.gameState.currentStreak = 0;
                }
                
                // Update category stats
                this.gameState.categoryStats[this.currentQuiz.category].played++;
                if (isCorrect) {
                    this.gameState.categoryStats[this.currentQuiz.category].correct++;
                }
                
                this.gameState.questionsAnswered++;
                document.getElementById('currentScore').textContent = this.currentQuiz.score;
                document.getElementById('streakDisplay').textContent = this.currentQuiz.streak;
                
                // Stop timer
                clearInterval(this.currentQuiz.timer);
                
                // Show next button or finish
                setTimeout(() => {
                    if (this.currentQuiz.currentIndex < this.currentQuiz.questions.length - 1) {
                        document.getElementById('nextButton').classList.remove('hidden');
                    } else {
                        this.finishQuiz();
                    }
                }, 1500);
            }

            nextQuestion() {
                this.currentQuiz.currentIndex++;
                this.displayQuestion();
                this.startTimer();
            }

            startTimer() {
                this.currentQuiz.timer = setInterval(() => {
                    this.currentQuiz.timeLeft--;
                    document.getElementById('quizTimer').textContent = this.currentQuiz.timeLeft;
                    
                    // Add warning animation when time is low
                    if (this.currentQuiz.timeLeft <= 10) {
                        document.getElementById('quizTimer').classList.add('timer-warning');
                    }
                    
                    if (this.currentQuiz.timeLeft <= 0) {
                        clearInterval(this.currentQuiz.timer);
                        // Auto-select wrong answer (timeout)
                        const options = document.querySelectorAll('.desktop-quiz-option');
                        if (!options[0].classList.contains('disabled')) {
                            this.selectAnswer(-1); // Invalid answer
                        }
                    }
                }, 1000);
            }

            finishQuiz() {
                clearInterval(this.currentQuiz.timer);
                
                // Calculate final stats
                const totalTime = Math.round((Date.now() - this.currentQuiz.startTime) / 1000);
                const accuracy = Math.round((this.currentQuiz.correctCount / this.currentQuiz.questions.length) * 100);
                
                // Update game state
                this.gameState.totalScore += this.currentQuiz.score;
                this.gameState.score += this.currentQuiz.score;
                this.gameState.gamesWon++;
                this.gameState.totalTime += totalTime;
                this.gameState.playTime += totalTime;
                
                if (this.currentQuiz.streak > this.gameState.bestStreak) {
                    this.gameState.bestStreak = this.currentQuiz.streak;
                }
                
                // Level up check
                const newLevel = Math.floor(this.gameState.score / 1000) + 1;
                if (newLevel > this.gameState.level) {
                    this.gameState.level = newLevel;
                }
                
                // Check for perfect score achievement
                if (accuracy === 100 && !this.achievements.find(a => a.id === 'perfect_score').unlocked) {
                    this.unlockAchievement('perfect_score');
                }
                
                // Update leaderboard
                const playerEntry = {
                    name: this.currentUser.name,
                    school: this.currentUser.school,
                    score: this.gameState.totalScore,
                    accuracy: this.gameState.questionsAnswered > 0 ? 
                        Math.round((this.gameState.correctAnswers / this.gameState.questionsAnswered) * 100) : 0
                };
                
                const existingIndex = this.leaderboard.findIndex(p => p.name === this.currentUser.name);
                if (existingIndex >= 0) {
                    this.leaderboard[existingIndex] = playerEntry;
                } else {
                    this.leaderboard.push(playerEntry);
                }
                
                this.leaderboard.sort((a, b) => b.score - a.score);
                this.leaderboard = this.leaderboard.slice(0, 10);
                
                // Save data
                this.saveGameState();
                this.saveLeaderboard();
                this.updateUI();
                
                // Show results
                this.showResults(accuracy, totalTime);
            }

            showResults(accuracy, totalTime) {
                const modal = document.getElementById('resultsModal');
                const resultIcon = document.getElementById('resultIcon');
                const resultTitle = document.getElementById('resultTitle');
                
                // Determine result type
                if (accuracy >= 90) {
                    resultIcon.textContent = '🎉';
                    resultTitle.textContent = 'Luar Biasa!';
                } else if (accuracy >= 70) {
                    resultIcon.textContent = '👏';
                    resultTitle.textContent = 'Bagus Sekali!';
                } else if (accuracy >= 50) {
                    resultIcon.textContent = '👍';
                    resultTitle.textContent = 'Cukup Baik!';
                } else {
                    resultIcon.textContent = '💪';
                    resultTitle.textContent = 'Terus Berlatih!';
                }
                
                // Update result stats
                document.getElementById('finalScore').textContent = this.currentQuiz.score.toLocaleString();
                document.getElementById('correctAnswers').textContent = `${this.currentQuiz.correctCount}/${this.currentQuiz.questions.length}`;
                document.getElementById('accuracy').textContent = accuracy + '%';
                document.getElementById('totalTime').textContent = totalTime + 's';
                document.getElementById('bestStreakResult').textContent = this.currentQuiz.streak;
                
                modal.classList.remove('hidden');
                modal.classList.add('flex');
            }

            closeResults() {
                document.getElementById('resultsModal').classList.add('hidden');
                document.getElementById('resultsModal').classList.remove('flex');
                this.showPage('home');
            }

            playAgain() {
                this.closeResults();
                this.startQuiz(this.currentQuiz.category);
            }

            showQuickPlay() {
                // Random category for quick play
                const categories = ['pancasila', 'konstitusi', 'demokrasi', 'nkri', 'bhinneka', 'ham'];
                const randomCategory = categories[Math.floor(Math.random() * categories.length)];
                this.startQuiz(randomCategory);
            }

            handleEscape() {
                // Close any open modals
                document.getElementById('resultsModal').classList.add('hidden');
                document.getElementById('resultsModal').classList.remove('flex');
                document.getElementById('loginModal').classList.add('hidden');
                document.getElementById('loginModal').classList.remove('flex');
                document.getElementById('profileModal').classList.add('hidden');
                document.getElementById('profileModal').classList.remove('flex');
                
                // If in quiz, go back to home
                if (this.currentPage === 'quiz') {
                    clearInterval(this.currentQuiz.timer);
                    this.showPage('home');
                }
            }

            // User Management Functions
            loadUsers() {
                const saved = localStorage.getItem('pknMasterUsers');
                if (saved) {
                    this.users = JSON.parse(saved);
                } else {
                    this.users = [];
                }
            }

            saveUsers() {
                localStorage.setItem('pknMasterUsers', JSON.stringify(this.users));
            }

            loadCurrentUser() {
                const saved = localStorage.getItem('pknMasterCurrentUser');
                if (saved) {
                    const userData = JSON.parse(saved);
                    this.currentUser = userData;
                    this.isLoggedIn = true;
                }
            }

            saveCurrentUser() {
                localStorage.setItem('pknMasterCurrentUser', JSON.stringify(this.currentUser));
            }

            updateLoginState() {
                const loginButton = document.getElementById('loginButton');
                const logoutButton = document.getElementById('logoutButton');
                const userName = document.getElementById('userName');
                const userAvatar = document.getElementById('userAvatar');

                if (this.isLoggedIn) {
                    loginButton.classList.add('hidden');
                    logoutButton.classList.remove('hidden');
                    userName.textContent = this.currentUser.name;
                    userAvatar.textContent = this.currentUser.avatar;
                } else {
                    loginButton.classList.remove('hidden');
                    logoutButton.classList.add('hidden');
                    userName.textContent = 'Guest Player';
                    userAvatar.textContent = '👨‍🎓';
                }
            }

            showLoginModal() {
                document.getElementById('loginModal').classList.remove('hidden');
                document.getElementById('loginModal').classList.add('flex');
                this.showLoginForm();
            }

            closeLoginModal() {
                document.getElementById('loginModal').classList.add('hidden');
                document.getElementById('loginModal').classList.remove('flex');
                this.clearLoginForms();
            }

            showLoginForm() {
                document.getElementById('loginForm').classList.remove('hidden');
                document.getElementById('registerForm').classList.add('hidden');
            }

            showRegisterForm() {
                document.getElementById('loginForm').classList.add('hidden');
                document.getElementById('registerForm').classList.remove('hidden');
            }

            clearLoginForms() {
                // Clear login form
                document.getElementById('loginUsername').value = '';
                document.getElementById('loginPassword').value = '';
                document.getElementById('rememberMe').checked = false;

                // Clear register form
                document.getElementById('registerName').value = '';
                document.getElementById('registerEmail').value = '';
                document.getElementById('registerUsername').value = '';
                document.getElementById('registerSchool').value = '';
                document.getElementById('registerPassword').value = '';
                document.getElementById('confirmPassword').value = '';
            }

            performLogin() {
                const username = document.getElementById('loginUsername').value.trim();
                const password = document.getElementById('loginPassword').value;

                if (!username || !password) {
                    this.showNotification('Mohon isi semua field!', 'error');
                    return;
                }

                // Find user
                const user = this.users.find(u => 
                    (u.username === username || u.email === username) && u.password === password
                );

                if (user) {
                    this.currentUser = { ...user };
                    this.isLoggedIn = true;
                    this.saveCurrentUser();
                    this.updateLoginState();
                    this.closeLoginModal();
                    this.showNotification(`Selamat datang kembali, ${user.name}!`, 'success');
                    
                    // Load user's game state
                    this.loadGameState();
                    this.updateUI();
                } else {
                    this.showNotification('Username/email atau password salah!', 'error');
                }
            }

            performRegister() {
                const name = document.getElementById('registerName').value.trim();
                const email = document.getElementById('registerEmail').value.trim();
                const username = document.getElementById('registerUsername').value.trim();
                const school = document.getElementById('registerSchool').value.trim();
                const password = document.getElementById('registerPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;

                // Validation
                if (!name || !email || !username || !school || !password || !confirmPassword) {
                    this.showNotification('Mohon isi semua field!', 'error');
                    return;
                }

                if (password !== confirmPassword) {
                    this.showNotification('Password tidak cocok!', 'error');
                    return;
                }

                if (password.length < 6) {
                    this.showNotification('Password minimal 6 karakter!', 'error');
                    return;
                }

                // Check if username or email already exists
                if (this.users.some(u => u.username === username)) {
                    this.showNotification('Username sudah digunakan!', 'error');
                    return;
                }

                if (this.users.some(u => u.email === email)) {
                    this.showNotification('Email sudah terdaftar!', 'error');
                    return;
                }

                // Create new user
                const newUser = {
                    id: Date.now().toString(),
                    name,
                    email,
                    username,
                    school,
                    password,
                    avatar: '👨‍🎓',
                    joinDate: new Date().toISOString()
                };

                this.users.push(newUser);
                this.saveUsers();

                // Auto login
                this.currentUser = { ...newUser };
                this.isLoggedIn = true;
                this.saveCurrentUser();
                this.updateLoginState();
                this.closeLoginModal();
                this.showNotification(`Selamat datang, ${name}! Akun berhasil dibuat.`, 'success');
                
                // Reset game state for new user
                this.gameState = {
                    score: 0,
                    level: 1,
                    gamesWon: 0,
                    questionsAnswered: 0,
                    currentStreak: 0,
                    totalScore: 0,
                    bestStreak: 0,
                    totalTime: 0,
                    correctAnswers: 0,
                    playTime: 0,
                    categoryStats: {
                        pancasila: { played: 0, correct: 0 },
                        konstitusi: { played: 0, correct: 0 },
                        demokrasi: { played: 0, correct: 0 },
                        nkri: { played: 0, correct: 0 },
                        bhinneka: { played: 0, correct: 0 },
                        ham: { played: 0, correct: 0 }
                    }
                };
                this.saveGameState();
                this.updateUI();
            }

            logout() {
                this.isLoggedIn = false;
                this.currentUser = {
                    id: null,
                    name: 'Guest Player',
                    username: '',
                    email: '',
                    school: 'Local Player',
                    avatar: '👨‍🎓',
                    joinDate: new Date().toISOString()
                };
                
                localStorage.removeItem('pknMasterCurrentUser');
                localStorage.removeItem('pknMasterDesktopState');
                
                // Reset game state
                this.gameState = {
                    score: 0,
                    level: 1,
                    gamesWon: 0,
                    questionsAnswered: 0,
                    currentStreak: 0,
                    totalScore: 0,
                    bestStreak: 0,
                    totalTime: 0,
                    correctAnswers: 0,
                    playTime: 0,
                    categoryStats: {
                        pancasila: { played: 0, correct: 0 },
                        konstitusi: { played: 0, correct: 0 },
                        demokrasi: { played: 0, correct: 0 },
                        nkri: { played: 0, correct: 0 },
                        bhinneka: { played: 0, correct: 0 },
                        ham: { played: 0, correct: 0 }
                    }
                };
                
                this.updateLoginState();
                this.updateUI();
                this.showNotification('Berhasil logout!', 'success');
            }

            showProfileModal() {
                if (!this.isLoggedIn) {
                    this.showLoginModal();
                    return;
                }

                // Update profile modal with current user data
                document.getElementById('profileName').textContent = this.currentUser.name;
                document.getElementById('profileSchool').textContent = this.currentUser.school;
                document.getElementById('profileAvatar').textContent = this.currentUser.avatar;
                document.getElementById('editName').value = this.currentUser.name;
                document.getElementById('editSchool').value = this.currentUser.school;

                // Update stats
                document.getElementById('profileLevel').textContent = this.gameState.level;
                document.getElementById('profileScore').textContent = this.gameState.totalScore.toLocaleString();
                
                const accuracy = this.gameState.questionsAnswered > 0 ? 
                    Math.round((this.gameState.correctAnswers / this.gameState.questionsAnswered) * 100) : 0;
                document.getElementById('profileAccuracy').textContent = accuracy + '%';

                // Calculate rank
                const userRank = this.leaderboard.findIndex(p => p.name === this.currentUser.name) + 1;
                document.getElementById('profileRank').textContent = userRank > 0 ? `#${userRank}` : '#-';

                document.getElementById('profileModal').classList.remove('hidden');
                document.getElementById('profileModal').classList.add('flex');
            }

            closeProfileModal() {
                document.getElementById('profileModal').classList.add('hidden');
                document.getElementById('profileModal').classList.remove('flex');
            }

            changeAvatar(avatar) {
                this.currentUser.avatar = avatar;
                document.getElementById('profileAvatar').textContent = avatar;
                document.getElementById('userAvatar').textContent = avatar;
            }

            saveProfile() {
                const newName = document.getElementById('editName').value.trim();
                const newSchool = document.getElementById('editSchool').value.trim();

                if (!newName || !newSchool) {
                    this.showNotification('Nama dan sekolah tidak boleh kosong!', 'error');
                    return;
                }

                // Update current user
                this.currentUser.name = newName;
                this.currentUser.school = newSchool;

                // Update in users array
                const userIndex = this.users.findIndex(u => u.id === this.currentUser.id);
                if (userIndex >= 0) {
                    this.users[userIndex] = { ...this.currentUser };
                    this.saveUsers();
                }

                this.saveCurrentUser();
                this.updateLoginState();
                
                // Update leaderboard entry
                const leaderboardIndex = this.leaderboard.findIndex(p => p.name === this.currentUser.name);
                if (leaderboardIndex >= 0) {
                    this.leaderboard[leaderboardIndex].name = newName;
                    this.leaderboard[leaderboardIndex].school = newSchool;
                    this.saveLeaderboard();
                }

                this.closeProfileModal();
                this.showNotification('Profil berhasil diperbarui!', 'success');
            }

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
                const icon = type === 'success' ? '✅' : type === 'error' ? '❌' : 'ℹ️';
                
                notification.className = `fixed top-4 right-4 ${bgColor} text-white p-4 rounded-xl shadow-lg z-50 transform translate-x-full transition-transform duration-300 max-w-sm`;
                notification.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <div class="text-xl">${icon}</div>
                        <div class="font-medium">${message}</div>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // Animate in
                setTimeout(() => {
                    notification.classList.remove('translate-x-full');
                }, 100);
                
                // Animate out after 3 seconds
                setTimeout(() => {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }
        }

        // Initialize PKN Master Desktop
        let pknMaster;

        document.addEventListener('DOMContentLoaded', () => {
            pknMaster = new PKNMasterDesktop();
            console.log('PKN Master Desktop v7 loaded successfully!');
        });

        // Global functions for onclick handlers
        function showPage(page) {
            pknMaster.showPage(page);
        }

        function toggleSidebar() {
            pknMaster.toggleSidebar();
        }

        function toggleMobileSidebar() {
            pknMaster.toggleMobileSidebar();
        }

        function showQuickPlay() {
            pknMaster.showQuickPlay();
        }

        function toggleFullscreen() {
            pknMaster.toggleFullscreen();
        }

        function startQuiz(category) {
            pknMaster.startQuiz(category);
        }

        function nextQuestion() {
            pknMaster.nextQuestion();
        }

        function closeResults() {
            pknMaster.closeResults();
        }

        function playAgain() {
            pknMaster.playAgain();
        }

        function updateLeaderboard() {
            pknMaster.updateLeaderboard();
        }

        function showLoginModal() {
            pknMaster.showLoginModal();
        }

        function closeLoginModal() {
            pknMaster.closeLoginModal();
        }

        function showLoginForm() {
            pknMaster.showLoginForm();
        }

        function showRegisterForm() {
            pknMaster.showRegisterForm();
        }

        function performLogin() {
            pknMaster.performLogin();
        }

        function performRegister() {
            pknMaster.performRegister();
        }

        function logout() {
            pknMaster.logout();
        }

        function showProfileModal() {
            pknMaster.showProfileModal();
        }

        function closeProfileModal() {
            pknMaster.closeProfileModal();
        }

        function changeAvatar(avatar) {
            pknMaster.changeAvatar(avatar);
        }

        function saveProfile() {
            pknMaster.saveProfile();
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97b45cdbe2385f54',t:'MTc1NzIyODc3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
